<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LukStore Bazar</title>

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

<style>
body{font-family:'Segoe UI',sans-serif;background:#f0f2f5;margin:0}
.hidden{display:none}
button{cursor:pointer}

#telaInicial{
height:100vh;display:flex;flex-direction:column;
justify-content:center;align-items:center;
background:linear-gradient(135deg,#2563eb,#7c3aed);
color:#fff;text-align:center
}
#telaInicial button{
padding:16px 32px;border:none;border-radius:16px;
font-size:18px;margin:10px;background:#fff;color:#2563eb;font-weight:bold
}

.box{
background:#fff;padding:25px;border-radius:18px;
max-width:500px;margin:20px auto;
box-shadow:0 10px 30px rgba(0,0,0,.15)
}
input,textarea{
width:100%;padding:12px;margin:6px 0;
border-radius:12px;border:1px solid #ddd
}

.cards{
display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
gap:20px;margin:20px
}
.card{
background:#fff;border-radius:16px;
box-shadow:0 6px 16px rgba(0,0,0,.15);
overflow:hidden;position:relative
}
.card img{width:100%;height:220px;object-fit:cover}
.card .info{padding:14px}
.preco{color:#16a34a;font-weight:bold}

.btnDelete{
position:absolute;top:10px;right:10px;
background:red;color:#fff;width:30px;height:30px;
border-radius:50%;display:flex;
align-items:center;justify-content:center;font-weight:bold
}

#painelBtn{
position:fixed;bottom:20px;right:20px;
background:#7c3aed;color:#fff;
padding:14px 20px;border-radius:18px;
display:none;font-weight:bold;
box-shadow:0 6px 16px rgba(0,0,0,.25)
}

.copy-btn{
background:#2563eb;color:#fff;border:none;
padding:6px 12px;border-radius:10px
}
</style>
</head>

<body>

<div id="telaInicial">
<h1>LukStore Bazar</h1>
<p>Você quer ser Vendedor ou Comprador?</p>
<button onclick="entrarVendedor()">Vendedor</button>
<button onclick="entrarComprador()">Comprador</button>
</div>

<main id="main" class="hidden">

<section id="home" class="hidden">
<h3 style="text-align:center">Produtos</h3>
<div class="cards" id="listaProdutos"></div>
</section>

<section id="pagamento" class="hidden">
<div class="box">
<h3>Ativar painel vendedor</h3>

<p><b>PIX:</b> dd1825ef-9839-4b1e-a525-33cd66c6507a</p>

<p style="display:flex;justify-content:space-between;align-items:center">
<span>
Enviar comprovante para o número<br>
<b id="numeroPix">5541997312887</b>
</span>
<button class="copy-btn" onclick="copiar()">Copiar</button>
</p>

<p><b>Valor:</b> R$ 10,00</p>

<p style="font-size:14px">
Após enviar o comprovante você receberá um código.<br>
Digite o código abaixo para liberar o painel.
</p>

<input id="codigo" placeholder="Código recebido (obrigatório)">
<input id="nomeVendedor" placeholder="Seu nome">
<input id="whatsapp" placeholder="WhatsApp">
<input type="file" id="foto">

<button onclick="ativarPainel()">Ativar acesso</button>
<p id="msg" style="color:red;font-weight:bold"></p>
</div>
</section>

<section id="painel" class="hidden">
<div class="box">
<h3>Painel do vendedor</h3>

<input id="pNome" placeholder="Nome do produto">
<input id="pPreco" placeholder="Preço">
<textarea id="pDesc" placeholder="Informações do produto"></textarea>
<input type="file" id="pFoto">

<button onclick="publicar()">Publicar produto</button>
<button onclick="abrirMeus()">Meus anúncios</button>
</div>
</section>

<section id="meus" class="hidden">
<div class="box">
<h3>Meus anúncios</h3>
<div class="cards" id="listaMeus"></div>
<button onclick="mostrar('painel')">Voltar</button>
</div>
</section>

</main>

<button id="painelBtn" onclick="mostrar('painel')">Painel Vendedor</button>

<script>
const firebaseConfig={
apiKey:"AIzaSyA6NR4-nA1MBIy1STy_VRvwBpMRbezOU1s",
authDomain:"lukstore-bazar.firebaseapp.com",
projectId:"lukstore-bazar"
}
firebase.initializeApp(firebaseConfig)
const db=firebase.firestore()

let vendedor={}

function mostrar(id){
document.querySelectorAll('main section').forEach(s=>s.classList.add('hidden'))
document.getElementById(id).classList.remove('hidden')
if(id==='home') carregarProdutos()
}

function entrarComprador(){
telaInicial.classList.add('hidden')
main.classList.remove('hidden')
mostrar('home')
}

function entrarVendedor(){
telaInicial.classList.add('hidden')
main.classList.remove('hidden')
mostrar('pagamento')
}

function copiar(){
navigator.clipboard.writeText('5541997312887')
alert('Número copiado!')
}

function ativarPainel(){
const cod=codigo.value.trim()
const ult=cod.slice(-1)
if(cod.length!==6||!['1','4','5','9'].includes(ult)){
msg.innerText='Código inválido'
return
}

vendedor={
nome:nomeVendedor.value,
whatsapp:whatsapp.value,
data:Date.now()
}

localStorage.setItem('vendedor',JSON.stringify(vendedor))
painelBtn.style.display='block'
mostrar('home')
}

function checarLogin(){
const v=localStorage.getItem('vendedor')
if(!v) return
const dados=JSON.parse(v)
if(Date.now()-dados.data>2592000000){
localStorage.removeItem('vendedor')
return
}
vendedor=dados
painelBtn.style.display='block'
}

function publicar(){
db.collection('produtos').add({
nome:pNome.value,
preco:pPreco.value,
desc:pDesc.value,
vendedor:vendedor.nome,
whatsapp:vendedor.whatsapp,
data:firebase.firestore.FieldValue.serverTimestamp()
}).then(()=>{
mostrar('meus')
abrirMeus()
})
}

function carregarProdutos(){
db.collection('produtos').onSnapshot(snap=>{
listaProdutos.innerHTML=''
snap.forEach(doc=>{
const p=doc.data()
const card=document.createElement('div')
card.className='card'
card.innerHTML=`
<div class="info">
<h4>${p.nome}</h4>
<div class="preco">R$ ${p.preco}</div>
<div>${p.vendedor}</div>
</div>`
listaProdutos.appendChild(card)
})
})
}

function abrirMeus(){
mostrar('meus')
db.collection('produtos')
.where('whatsapp','==',vendedor.whatsapp)
.onSnapshot(snap=>{
listaMeus.innerHTML=''
snap.forEach(doc=>{
const p=doc.data()
const card=document.createElement('div')
card.className='card'
card.innerHTML=`
<div class="btnDelete">X</div>
<div class="info">
<h4>${p.nome}</h4>
<div class="preco">R$ ${p.preco}</div>
</div>`
card.querySelector('.btnDelete').onclick=()=>{
if(confirm('Apagar anúncio?')){
db.collection('produtos').doc(doc.id).delete()
}
}
listaMeus.appendChild(card)
})
})
}

checarLogin()
</script>

</body>
  </html>
